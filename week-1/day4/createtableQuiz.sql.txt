create table Province (
	prov_id SERIAL primary key,
	prov_name varchar(100)
);

create table City (
	city_id serial primary key,
	city_name varchar(100),
	city_prov_id int,
	foreign key (city_prov_id) references Province (prov_id) ON UPDATE CASCADE ON DELETE CASCADE
);

create table Address (
	addr_id serial primary key,
	addr_email varchar(55),
	addr_fullname varchar (55),
	addr_phone_number varchar(18),
	adr_is_default boolean,
	addr_zipcode varchar(15),
	addr_street1 varchar(255),
	addr_stree2 varchar(255),
	addr_city_id int,
	addr_user_id int,
	
	foreign key (addr_city_id) references city(city_id) ON UPDATE CASCADE ON DELETE CASCADE
);

create table Users (
	user_id serial primary key,
	user_name varchar(55),
	user_email varchar(55),
	user_password varchar (255)
);

alter table address add foreign key (addr_user_id) references users(user_id) ON UPDATE CASCADE ON DELETE CASCADE;

create table Roles (
	role_id serial primary key,
	role_name varchar
);

create table user_roles (
	user_id int,
	role_id int,
	foreign key (user_id) references users(user_id) ON UPDATE CASCADE ON DELETE CASCADE,
	foreign key (role_id) references roles(role_id) ON UPDATE CASCADE ON DELETE CASCADE
);

create table Orders(
	order_name varchar(55) primary key,
	order_create_on timestamp,
	order_is_closed boolean,
	order_total int,
	order_user_id int,
	
	foreign key (order_user_id) references users(user_id) ON UPDATE CASCADE ON DELETE CASCADE
);

create table Cart (
	cart_id serial primary key,
	cart_created_on timestamp,
	cart_is_closed boolean,
	cart_total int,
	cart_user_id int,
	foreign key (cart_user_id) references users(user_id) ON UPDATE CASCADE ON DELETE CASCADE
);

create table Category (
	cate_id serial primary key,
	cate_name varchar(25)
);

create table Product (
	prod_id serial primary key,
	prod_title varchar(25),
	prod_description varchar(255),
	prod_stock int,
	prod_price int,
	prod_condition varchar(15),
	prod_manufacture varchar(25),
	prod_image varchar(100),
	prod_cate_id int,
	
	foreign key (prod_cate_id) references category(cate_id) ON UPDATE CASCADE ON DELETE CASCADE
);

create table products_images(
	prim_id uuid,
	prim_file_name varchar(255),
	prim_path varchar(255),
	prim_prod_id int,
	
	foreign key (prim_prod_id) references product(prod_id) ON UPDATE CASCADE ON DELETE CASCADE
);

create table order_detail(
	ordi_quantity int,
	ordi_price int,
	ordi_cart_id int,
	ordi_prod_id int,
	ordi_order_name varchar(55),
	
	foreign key (ordi_cart_id) references cart(cart_id) ON UPDATE CASCADE ON DELETE CASCADE,
	foreign key (ordi_prod_id) references product(prod_id) ON UPDATE CASCADE ON DELETE CASCADE,
	foreign key (ordi_order_name) references orders(order_name) ON UPDATE CASCADE ON DELETE CASCADE
);


